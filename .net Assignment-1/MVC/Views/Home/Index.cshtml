@{
    ViewData["Title"] = "Home Page";
}

<html>

<head>
    <title>EmpList</title>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
     <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.2/css/jquery.dataTables.css">

   
    <script>


        $(document).ready(function () {
            $("#submit").click(function () {


                var x = document.getElementById("select").value;
                var get = new Object();

                get.empName = $("#name").val(),

                    get.DeptId = $("#select").val(),
                    get.salary = $("#salary").val()
                if (get.empName != "" && get.DeptId != "" && get.salary != "") {

                    $.ajax({

                        type: 'post',
                        contentType: 'Application/json',
                        data: JSON.stringify(get),
                        url: 'https://localhost:7131/api/EmployeeApi',
                        success: function (result, status, xhr) {

                            window.location.replace("https://localhost:7053/");

                        }

                    }
                    )

                }

                else {
                    alert('All fields Are Required.');
                }


            });


            //Employee Listing

            $.ajax(
                {
                    type: 'Get',
                    contentType: 'Application/json',

                    url: 'https://localhost:7131/api/EmployeeApi',

                    success: function (result, status, xhr) {

                        $.each(result, function (index, value) {

                            var rows = "<tr>" +
                                "<td>" + value.empId + "</td>" +
                                "<td>" + value.empName + "</td>" +
                                "<td>" + value.deptName + "</td>" +
                                "<td>" + value.salary + "</td> " +
                                "<td><input type='button' class='btn btn-outline-info' data-bs-toggle='modal' data-bs-target='#exampleModal21' value='Edit' id='edit' onclick='Edit(" + value.empId + ")'> <input type='button' class='btn btn-outline-danger' value='Delete' id='delete' onclick='Delete(" + value.empId + ")'>" +
                                "</td>" +
                                "</tr>";
                            $("#List").append(rows);
                        });
                    }

                }
            )
            //dropdown//
            $.ajax(
                {
                    type: 'Get',
                    contentType: 'Application/json',

                    url: 'https://localhost:7131/api/EmployeeApi/department',

                    success: function (result, status, xhr) {
                        $.each(result, function (index, value) {


                            $("#select").append('<option value="' + value.id + '">' + value.deptName + '</option>');
                            $("#select1").append('<option value="' + value.id + '">' + value.deptName + '</option>');
                        }
                        );

                    }
                }
            )
        

            $("#Deptbtn").click(function () {

                $("#List").hide();
                 $("#SearchList").hide();
                $("#DeptList").show();

                $.ajax({
                    type: 'Get',
                    contentType: 'Application/json',
                    url: 'https://localhost:7131/api/EmployeeApi/dept',
                    success: function (result, status, xhr) {

                        $.each(result, function (index, value) {
                            var rows21 = "<tr>" +
                                "<td>" + value.department + "</td>" +
                                "<td>" + value.total + "</td>" +
                                "<td>" + value.salary + "</td> " +
                                "</tr>";
                            $("#DeptList").append(rows21);



                        });
                    }
                     })
           })
           });

        function Delete(EmpId) {
            var x = confirm('are you Sure to Delete?');

            if (x == true) {
                $(document).ready(function () {

                    $.ajax({

                        type: 'Delete',
                        contentType: 'Application/json',
                        url: 'https://localhost:7131/api/EmployeeApi?id=' + EmpId,

                        success: function (result, status, xhr) {

                            window.location.replace("https://localhost:7053/");
                        }


                    })



                })
            }

        }
        function Edit(EmpId) {
            $(document).ready(function () {

                $.ajax({

                    type: 'Get',
                    contentType: 'Application/json',
                    url: 'https://localhost:7131/api/EmployeeApi/all?id=' + EmpId,
                    success: function (result, status, xhr) {
                        $("#EmpId").val(result.empId),

                            $("#uname").val(result.empName),

                            $("#usalary").val(result.salary)
                    }
                }
                )


            })




        }



        //update
        function update() {
            var x = document.getElementById("select1").value;
            console.log(x);


            $(document).ready(function () {



                var get = new Object();

                get.empId = $("#EmpId").val();
                get.empName = $("#uname").val();
                get.DeptId = $("#select1").val();
                get.salary = $("#usalary").val();

                if (get.empId != "" && get.empName != "" && get.DeptId != "" && get.salary != "") {
                    $.ajax(
                        {

                            type: 'PUT',
                            contentType: 'application/json',
                            data: JSON.stringify(get),
                            url: 'https://localhost:7131/api/EmployeeApi',
                            success: function (result, status, xhr) {
                                window.location.replace("https://localhost:7053/");

                            }


                        }
                    )

                }
                else {

                    alert("All Fields are Mandatory.");

                }



            })

        }



        function find1() {

             var x = document.getElementById('isearch').value;



            if (/^[0-9]+$/.test(x)) {
                $(document).ready(function () {
                    $("#SearchList").show();
                      $("#DeptList").hide();


                    $("#List").hide();

                    $.ajax({

                        type: 'Get',
                        contentType: 'Application/json',
                        url: 'https://localhost:7131/api/EmployeeApi/EmpId?id=' + x,
                        success: function (result, status, xhr) {
                            if (result.length == 0) {

                                $("#alert1").show();

                            }

                            $.each(result, function (index, value) {

                                var searchrows = "<tr id='tr'>" +
                                    "<td>" + value.empId + "</td>" +
                                    "<td>" + value.empName + "</td>" +
                                    "<td>" + value.deptName + "</td>" +
                                    "<td>" + value.salary + "</td> " +
                                    "<td><input type='button' class='btn btn-outline-info' data-bs-toggle='modal' data-bs-target='#exampleModal21' value='Edit' id='edit' onclick='Edit(" + value.empId + ")'> <input type='button' class='btn btn-outline-danger' value='Delete' id='delete' onclick='Delete(" + value.empId + ")'>" +
                                    "</td>" +
                                    "</tr>";
                                $("#SearchList").append(searchrows);


                            });

                        }


                    })


                })



            }

            else {
                $(document).ready(function () {
                    $("#SearchList").show();
                    $("#List").hide();
                    $("#isearch").val('');

                    $.ajax({

                        type: 'Get',
                        contentType: 'Application/json',
                        url: 'https://localhost:7131/api/EmployeeApi/byname?name=' + x,
                        success: function (result, status, xhr) {
                            if (result.length == 0) {

                                $.ajax({

                                    type: 'Get',
                                    contentType: 'Application/json',
                                    url: 'https://localhost:7131/api/EmployeeApi/bydept?deptname=' + x,
                                    success: function (result, status, xhr) {
                                        if (result.length == 0) {

                                            $("#alert1").show();

                                        }
                                        $.each(result, function (index, value) {

                                            var searchrows = "<tr id='tr'>" +
                                                "<td>" + value.empId + "</td>" +
                                                "<td>" + value.empName + "</td>" +
                                                  "<td>" + value.deptName + "</td>" +
                                                "<td>" + value.salary + "</td> " +
                                                "<td><input type='button' class='btn btn-outline-info' data-bs-toggle='modal' data-bs-target='#exampleModal21' value='Edit' id='edit' onclick='Edit(" + value.empId + ")'> <input type='button' class='btn btn-outline-danger' value='Delete' id='delete' onclick='Delete(" + value.empId + ")'>" +
                                                "</td>" +
                                                "</tr>";
                                            $("#SearchList").append(searchrows);
                                        });
                                    }
                                })

                            }
                            $.each(result, function (index, value) {

                                var searchrows = "<tr id='tr'>" +
                                    "<td>" + value.empId + "</td>" +
                                    "<td>" + value.empName + "</td>" +
                                    "<td>" + value.deptName + "</td>" +
                                    "<td>" + value.salary + "</td> " +
                                    "<td><input type='button' class='btn btn-outline-info' data-bs-toggle='modal' data-bs-target='#exampleModal21' value='Edit' id='edit' onclick='Edit(" + value.empId + ")'> <input type='button' class='btn btn-outline-danger' value='Delete' id='delete' onclick='Delete(" + value.empId + ")'>" +
                                    "</td>" +
                                    "</tr>";
                                $("#SearchList").append(searchrows);
                            });

                        }
                    })
                })

            }

        }
    


     
          
    </script>
</head>

<body>
    <div>
        <a class="btn btn-outline-success d-flex float-end mb-2 rounded-3" data-bs-toggle="modal"
            data-bs-target="#exampleModal" id="addbtn"> Add Employee</a>
        <button class="btn btn-outline-success d-flex float-end mb-2 rounded-3" style="margin-right: 6px;"
            id="Deptbtn">Department
            List</button>
        <a class="btn btn-outline-success d-flex float-end mb-2" asp-controller="Home" asp-action="Index"
            style="margin-right: 6px;">EmpList</a>

        <div class="d-flex float-end">
            <input type="search" id='isearch' class="form-control" style="margin-right: 4px;"
                aria-label="Recipient's username" aria-describedby="ifind">

            <button class="btn btn-outline-success" id='ifind' style="margin-right: 6px;"
                onclick="find1()">Search</button>
        </div>

    </div>


    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Insert Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                    <div class="col mb-3">
                        <input type="text" class="form-control" placeholder="Employee Name" aria-label="name" id="name">
                    </div>
                    <div class="col mb-3">

                        <select id="select" class=" dropdown w-100 form-control" onchange="select1()">
                            <option selected>Select Department</option>

                        </select>
                    </div>

                    <div class="col mb-3">
                        <input type="text" class="form-control" placeholder="Department" aria-label="dept"
                            id="Department" style="display: none;">
                    </div>

                    <div class="col mb-3">
                        <input type="text" class="form-control" placeholder="Salary" aria-label="sal" id="salary">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-outline-success" id="submit">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="exampleModal21" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Update Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="col mb-3">
                        <input type="text" class="form-control" placeholder="Id" aria-label="name" id="EmpId" disabled>
                    </div>
                    <div class="col mb-3">
                        <input type="text" class="form-control" placeholder="Employee Name" aria-label="name"
                            id="uname">
                    </div>
                    <div class="col mb-3">

                        <select id="select1" class=" dropdown w-100 form-control">
                            <option selected>Select Department</option>

                        </select>
                    </div>


                    <div class="col mb-3">
                        <input type="text" class="form-control" placeholder="Salary" aria-label="sal" id="usalary">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-outline-success" id="update" onclick="update()">Save</button>
                </div>
            </div>
        </div>
    </div>

    <table class="table table-dark text-center" id="List">
        <thead>
            <th>Emp Id</th>
            <th>Emp Name</th>
            <th>Department Name</th>
            <th>Salary</th>
            <th>Action</th>
        </thead>
        <tbody class="table table-primary"  id='tbody1'>


        </tbody>

    </table>
    <table class="table table-dark text-center" id="SearchList" style="display: none;">
        <thead>
            <th>Emp Id</th>
            <th>Emp Name</th>
            <th>Department Name</th>
            <th>Salary</th>
            <th>Action</th>
        </thead>
        <tbody class="table table-primary">


        </tbody>

    </table>
    <div class="alert alert-danger text-center fw-bold" role="alert" id='alert1' style="display: none;">
        Data Not Found!
    </div>
    <table class="table table-dark text-center" id="DeptList" style="display: none;">
        <thead>
            <th>Department Name</th>
            <th>No of Employee</th>
            <th>Total Salary</th>

        </thead>
        <tbody class="table table-success">


        </tbody>

    </table>

 
 <script src="js/jquery.dataTables.min.js" type="text/javascript"></script>
     <script type="text/javascript" charset="utf8"  src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/alfrcr/paginathing/dist/paginathing.min.js"></script>
	
</body>

</html>
